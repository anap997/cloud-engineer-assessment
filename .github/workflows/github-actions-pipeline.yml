name: GitHub Actions 
run-name: ${{ github.actor }} is testing

on:
  workflow_dispatch:
    inputs:
      BUMP_VERSION:
        required: false
        type: choice
        options:
        - ''
        - major
        - minor
        - patch
        - release


  jobs:
    runs-on: ubuntu-latest
    steps:
      - name: Version Bump
      run: |
          if inputs.BUMP_VERSION == ''; then
            bumpversion release
          else 
            bumpversion {{ inputs.BUMP_VERSION }}
          fi 
          NAME=todoapp
          VERSION=$(cat ./version)
          docker build  . -t $NAME:$VERSION
          git add --all
          git commit -m "Bumping version to $VERSION" || true
          git push
          docker push anapetrovska/$NAME:$VERSION

          
      

      